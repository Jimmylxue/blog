# 有效的数独

::: tip 考点
难度：**中级**

思想：**遍历**、**数据处理**
:::

---

:::demo

```vue
<template>
  <div class="demo">
    <iframe
      src="//player.bilibili.com/player.html?aid=423008586&bvid=BV1r3411e7Fx&cid=480740745&page=1"
      scrolling="no"
      border="0"
      frameborder="no"
      framespacing="0"
      allowfullscreen="true"
    >
    </iframe>
  </div>
</template>
<style>
.demo > iframe {
  width: 100%;
  height: 450px;
}
</style>
```

:::

### 题目

请你判断一个 9 x 9 的数独是否有效。只需要 根据以下规则 ，验证已经填入的数字是否有效即可。

数字 1-9 在每一行只能出现一次。
数字 1-9 在每一列只能出现一次。
数字 1-9 在每一个以粗实线分隔的 3x3 宫内只能出现一次。（请参考示例图）

注意：

一个有效的数独（部分已被填充）不一定是可解的。
只需要根据以上规则，验证已经填入的数字是否有效即可。
空白格用 '.' 表示。

```js
示例 1：

输入：board =
[
   ["5","3",".",".","7",".",".",".","."]
  ,["6",".",".","1","9","5",".",".","."]
  ,[".","9","8",".",".",".",".","6","."]
  ,["8",".",".",".","6",".",".",".","3"]
  ,["4",".",".","8",".","3",".",".","1"]
  ,["7",".",".",".","2",".",".",".","6"]
  ,[".","6",".",".",".",".","2","8","."]
  ,[".",".",".","4","1","9",".",".","5"]
  ,[".",".",".",".","8",".",".","7","9"]
]
输出：true
示例 2：

输入：board =
[
   ["8","3",".",".","7",".",".",".","."]
  ,["6",".",".","1","9","5",".",".","."]
  ,[".","9","8",".",".",".",".","6","."]
  ,["8",".",".",".","6",".",".",".","3"]
  ,["4",".",".","8",".","3",".",".","1"]
  ,["7",".",".",".","2",".",".",".","6"]
  ,[".","6",".",".",".",".","2","8","."]
  ,[".",".",".","4","1","9",".",".","5"]
  ,[".",".",".",".","8",".",".","7","9"]
]
输出：false
```

解释：除了第一行的第一个数字从 5 改为 8 以外，空格内其他数字均与 示例 1 相同。 但由于位于左上角的 3x3 宫内有两个 8 存在, 因此这个数独是无效的。

### 解题思路

这种题目应该是有巧解的方法的，我试着根据思路进行解题，最终发现算法的内存消耗和时间都蛮不错的，所以也记录一下解题思路。

![image-20220109161407447](https://vitepress-source.oss-cn-beijing.aliyuncs.com/typoraimage-20220109161407447.png)

根据数独的游戏规则，我们需要判断：

- 数字 1-9 在每一行只能出现一次。
- 数字 1-9 在每一列只能出现一次。
- 每个九宫格内数字 1-9 只能出现一次

行和列都相对好做，只需遍历二位数组时稍加判断即可，相对复杂一点的是如何处理 9 宫格的数字，在这题中，我们需要借助坐标来进行判断，将每个点拆解为如下的坐标：

![image-20220109162713756](https://vitepress-source.oss-cn-beijing.aliyuncs.com/typoraimage-20220109162713756.png)

然后做以下几件事：

- 处理之前先初始化好一个二维数组 `[[], [], [], [], [], [], [], [], []]`,存放每个格子的元素

- 然后将 **行和列分别除 3** 之后 根据行和列的值进行判断应该插入到具体的哪个数组中 根据 `行*3+列` 这个公式

  如：（5，5）这个点 计算之后 行=1 列=1 根据公式 `行\*3+列 = 4` 所以应该放入数组的下标 4 的位置（从 0 开始的）

- 做到这一步就可以解题啦~

### 源代码

```js
/**
 * @param {character[][]} board
 * @return {boolean}
 */
var isValidSudoku = function (board) {
  let rowGap = [];
  let colGap = [];
  let boxGap = [[], [], [], [], [], [], [], [], []];
  for (let i = 0; i < board.length; i++) {
    // 处理列
    colGap = [];
    for (let l = 0; l < board.length; l++) {
      if (board[l][i] !== '.') {
        if (colGap.includes(board[l][i])) {
          return false;
        } else {
          colGap.push(board[l][i]);
        }
      }
    }

    for (let j = 0; j < board[i].length; j++) {
      // 处理格子
      let m = parseInt(i / 3),
        n = parseInt(j / 3);
      if (board[i][j] !== '.') {
        if (boxGap[m * 3 + n].includes(board[i][j])) {
          return false;
        } else {
          boxGap[m * 3 + n].push(board[i][j]);
        }
      }
      // 处理行
      if (j === 0) {
        rowGap = [];
      }
      if (j <= board[i].length - 1) {
        if (board[i][j] !== '.') {
          if (rowGap.includes(board[i][j])) {
            return false;
          } else {
            rowGap.push(board[i][j]);
          }
        }
      }
    }
  }
  return true;
};
```
